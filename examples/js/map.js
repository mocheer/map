!function(t){function o(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}var r={};return o.m=t,o.c=r,o.p="",o(0)}([function(t,o,r){"use strict";function n(){String.prototype.format||(String.prototype.format=function(t){var o=this;if(arguments.length>0)if(1==arguments.length&&"object"==typeof t){for(var r in t)if(void 0!=t[r]){var n=new RegExp("({"+r+"})","g");o=o.replace(n,t[r])}}else for(var i=0;i<arguments.length;i++)if(void 0!=arguments[i]){var n=new RegExp("({["+i+"]})","g");o=o.replace(n,arguments[i])}return o})}var i=r(1),e=function(){function t(t){this.provider=t,this.mapProvider=new i.MapProvider(t)}return t.prototype.getMapTile=function(t,o,r){return this.mapProvider.getMapTile(t,o,r)},t}();o.MapServer=e,function(t,o){t.document?o(t):function(t){if(!t.document)throw new Error("MapServer requires a window with a document");return o(t)}}("undefined"!=typeof window?window:this,function(t,o){o||(t.MapServer=e,n())})},function(t,o,r){"use strict";var n=r(2),i=r(8),e=r(10),a=r(11),u=r(12),s={GoogleProvider_AERIAL:n.GoogleProvider_AERIAL,GoogleProvider_HYBRID:n.GoogleProvider_HYBRID,GoogleProvider_ROAD:n.GoogleProvider_ROAD,BaiduProvider_AERIAL:i.BaiduProvider_AERIAL,BaiduProvider_ROAD:i.BaiduProvider_ROAD,TianDiProvider_AERIAL:a.TianDiProvider_AERIAL,TianDiProvider_ROAD:a.TianDiProvider_ROAD,GaoDeProvider_AERIAL:e.GaoDeProvider_AERIAL,GaoDeProvider_ROAD:e.GaoDeProvider_ROAD},c=function(){function t(t){t=s[t],t&&(this.provider=new t)}return t.prototype.getMapTile=function(t,o,r){var n=new u.MapTile(this.provider,t,o,r);return n},t}();o.MapProvider=c},function(t,o,r){"use strict";var n=this&&this.__extends||function(t,o){function r(){this.constructor=t}for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)},i=r(3),e=function(t){function o(){t.call(this)}return n(o,t),o.prototype.getTileUrls=function(t){if(t.row<0||t.row>=Math.pow(2,t.zoom))return null;var o=this.sourceCoordinate(t),r=t.row%4,n="Galileo".substr(0,Math.floor(8*Math.random())),i=this.urlTemplate,e=i.format(r,o.column,o.row,o.zoom,n);return[e]},o.prototype.toString=function(){return"GoogleProvider_"+this.type},o}(i.AbstractMapProvider);o.GoogleProvider=e;var a=function(t){function o(){t.call(this),this.type="AERIAL",this.urlTemplate="http://mt{0}.google.cn/vt/lyrs=y&hl=zh-CN&gl=cn&x={1}&y={2}&z={3}&s={4}"}return n(o,t),o}(e);o.GoogleProvider_AERIAL=a;var u=function(t){function o(){t.call(this),this.type="HYBRID",this.urlTemplate="http://mt{0}.google.cn/vt/lyrs=p&hl=zh-CN&gl=cn&x={1}&y={2}&z={3}&s={4}"}return n(o,t),o}(e);o.GoogleProvider_HYBRID=u;var s=function(t){function o(){t.call(this),this.type="ROAD",this.urlTemplate="http://mt{0}.google.cn/vt/lyrs=m&hl=zh-CN&gl=cn&x={1}&y={2}&z={3}&s={4}"}return n(o,t),o}(e);o.GoogleProvider_ROAD=s},function(t,o,r){"use strict";var n=r(4),i=r(5),e=r(6),a=function(){function t(o,r,a,u){void 0===o&&(o=t.MIN_ZOOM),void 0===r&&(r=t.MAX_ZOOM),void 0===a&&(a=0),void 0===u&&(u=0);var s=new i.Transformation(10680707.79,0,33554431.85+a,0,(-10680708.9),33554430.57+u);this.projection=new e.MercatorProjection(26,s),this.topLeftOutLimit=new n.Coordinate(0,Number.NEGATIVE_INFINITY,o),this.bottomRightInLimit=new n.Coordinate(1,Number.POSITIVE_INFINITY,0).zoomTo(r)}return t.prototype.geometry=function(){return this.projection.toString()},t.prototype.sourceCoordinate=function(t){for(var o=t.column%Math.pow(2,t.zoom);o<0;)o+=Math.pow(2,t.zoom);return new n.Coordinate(t.row,o,t.zoom)},t.prototype.outerLimits=function(){return[this.topLeftOutLimit.clone(),this.bottomRightInLimit.clone()]},t.prototype.locationCoordinate=function(t){return this.projection.locationCoordinate(t)},t.prototype.coordinateLocation=function(t){return this.projection.coordinateLocation(t)},Object.defineProperty(t.prototype,"tileWidth",{get:function(){return 256},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tileHeight",{get:function(){return 256},enumerable:!0,configurable:!0}),t.MIN_ZOOM=1,t.MAX_ZOOM=20,t}();o.AbstractMapProvider=a},function(t,o){"use strict";var r=function(){function t(t,o,r){this.row=t,this.column=o,this.zoom=r}return t.prototype.container=function(){return new t(Math.floor(this.row),Math.floor(this.column),this.zoom)},t.prototype.zoomTo=function(o){return new t(this.row*Math.pow(2,o-this.zoom),this.column*Math.pow(2,o-this.zoom),o)},t.prototype.zoomBy=function(o){return new t(this.row*Math.pow(2,o),this.column*Math.pow(2,o),this.zoom+o)},t.prototype.isRowEdge=function(){return Math.round(this.row)==this.row},t.prototype.isColumnEdge=function(){return Math.round(this.column)==this.column},t.prototype.isEdge=function(){return this.isRowEdge()&&this.isColumnEdge()},t.prototype.up=function(o){return void 0===o&&(o=1),new t(this.row-o,this.column,this.zoom)},t.prototype.right=function(o){return void 0===o&&(o=1),new t(this.row,this.column+o,this.zoom)},t.prototype.down=function(o){return void 0===o&&(o=1),new t(this.row+o,this.column,this.zoom)},t.prototype.left=function(o){return void 0===o&&(o=1),new t(this.row,this.column-o,this.zoom)},t.prototype.equalTo=function(t){return t&&t.row==this.row&&t.column==this.column&&t.zoom==this.zoom},t.prototype.clone=function(){return new t(this.row,this.column,this.zoom)},t.prototype.toString=function(){return this.column+","+this.row+","+this.zoom},t}();o.Coordinate=r},function(t,o){"use strict";var r=function(){function t(t,o,r,n,i,e){this.ax=t,this.bx=o,this.cx=r,this.ay=n,this.by=i,this.cy=e}return t.prototype.toString=function(){return"T(["+this.ax+","+this.bx+","+this.cx+"]["+this.ay+","+this.by+","+this.cy+"])"},t.prototype.transform=function(t){var o=t[0],r=t[1];return[this.ax*o+this.bx*r+this.cx,this.ay*o+this.by*r+this.cy]},t.prototype.untransform=function(t){var o=t[0],r=t[1];return[(o*this.by-r*this.bx-this.cx*this.by+this.cy*this.bx)/(this.ax*this.by-this.ay*this.bx),(o*this.ay-r*this.ax-this.cx*this.ay+this.cy*this.ax)/(this.bx*this.ay-this.by*this.ax)]},t}();o.Transformation=r},function(t,o,r){"use strict";var n=r(7),i=r(4),e=function(){function t(t,o){o&&(this.T=o),this.zoom=t}return t.prototype.project=function(t){return t=this.rawProject(t),this.T&&(t=this.T.transform(t)),t},t.prototype.unproject=function(t){return this.T&&(t=this.T.untransform(t)),this.rawUnproject(t)},t.prototype.locationCoordinate=function(t){var o=this.project([Math.PI*t.lon/180,Math.PI*t.lat/180]);return new i.Coordinate(o[1],o[0],this.zoom)},t.prototype.coordinateLocation=function(t){t=t.zoomTo(this.zoom);var o=[t.column,t.row];return o=this.unproject(o),new n.LonLat(180*o[0]/Math.PI,180*o[1]/Math.PI)},t.prototype.rawProject=function(t){return[t[0],Math.log(Math.tan(.25*Math.PI+.5*t[1]))]},t.prototype.rawUnproject=function(t){return[t[0],2*Math.atan(Math.pow(Math.E,t[1]))-.5*Math.PI]},t.prototype.toString=function(){return"Mercator("+this.zoom+", "+this.T.toString()+")"},t}();o.MercatorProjection=e},function(t,o){"use strict";var r=function(){function t(t,o){this.lon=t,this.lat=o}return t.fromString=function(o,r){void 0===r&&(r=!0);var n=o.split(/\s*,\s*/,2);return r||(n=n.reverse()),new t(parseFloat(n[0]),parseFloat(n[1]))},t.prototype.equals=function(t){return t&&t.lat==this.lat&&t.lon==this.lon},t.prototype.clone=function(){return new t(this.lon,this.lat)},t.prototype.normalize=function(){var o=this.clone();for(o.lat=Math.max(t.MIN_LAT,Math.min(t.MAX_LAT,o.lat));o.lon>180;)o.lon-=360;for(;o.lon<-180;)o.lon+=360;return o},t.prototype.toString=function(t){return void 0===t&&(t=5),[this.lon.toFixed(t),this.lat.toFixed(t)].join(",")},t.MAX_LAT=84,t.MIN_LAT=-84,t.MAX_LON=180,t.MIN_LON=-180,t}();o.LonLat=r},function(t,o,r){"use strict";var n=this&&this.__extends||function(t,o){function r(){this.constructor=t}for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)},i=r(3),e=r(4),a=r(5),u=r(9),s=function(t){function o(){t.call(this);var o=new a.Transformation(1,0,131072,0,(-1),131072);this.projection=new u.BaiduProjection(18,o),this.topLeftOutLimit=new e.Coordinate(0,0,1),this.bottomRightInLimit=new e.Coordinate(1,1,0).zoomTo(19)}return n(o,t),o.prototype.getTileUrls=function(t){if(t.row<0||t.row>=Math.pow(2,t.zoom))return null;var o=(this.sourceCoordinate(t),Math.pow(2,18-t.zoom)),r=t.column-131072/o,n=131072/o-t.row-1,i=t.row%4,e=this.urlTemplate,a=e.format(i,r.toString().replace("-","M"),n.toString().replace("-","M"),t.zoom);return[a]},o.prototype.toString=function(){return"BaiduProvider_"+this.type},o}(i.AbstractMapProvider);o.BaiduProvider=s;var c=function(t){function o(){t.call(this),this.type="AERIAL",this.urlTemplate="http://online{0}.map.bdimg.com/tile/?qt=tile&x={1}&y={2}&z={3}&styles=sl&v=068&udt=20150418"}return n(o,t),o}(s);o.BaiduProvider_AERIAL=c;var h=function(t){function o(){t.call(this),this.type="ROAD",this.urlTemplate="http://online{0}.map.bdimg.com/tile/?qt=tile&x={1}&y={2}&z={3}&styles=pl&udt=20150421&scaler=1"}return n(o,t),o}(s);o.BaiduProvider_ROAD=h},function(t,o,r){"use strict";var n=this&&this.__extends||function(t,o){function r(){this.constructor=t}for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)},i=r(6),e=r(7),a=r(4),u=function(t){function o(){t.apply(this,arguments)}return n(o,t),o.prototype.rawProject=function(t){return o.convertLL2MC(t)},o.prototype.rawUnproject=function(t){return o.convertMC2LL(t)},o.prototype.locationCoordinate=function(t){var o=this.project([t.lon,t.lat]);return new a.Coordinate(o[1],o[0],this.zoom)},o.prototype.coordinateLocation=function(t){t=t.zoomTo(this.zoom);var o=[t.column,t.row];return o=this.unproject(o),new e.LonLat(o[0],o[1])},o.convertMC2LL=function(t){t=[256*t[0],256*t[1]];var r,n;r=[Math.abs(t[0]),Math.abs(t[1])];for(var i=0;i<o.MCBAND.length;i++)if(r[1]>=o.MCBAND[i]){n=o.MC2LL[i];break}return o.convertor(t,n)},o.convertLL2MC=function(t){var r,n;r=[o.getLoop(t[0],-180,180),o.getRange(t[1],-74,74)];var i;for(i=0;i<o.LLBAND.length;i++)if(r[1]>=o.LLBAND[i]){n=o.LL2MC[i];break}if(!n)for(i=o.LLBAND.length-1;i>=0;i--)if(t[1]<=-o.LLBAND[i]){n=o.LL2MC[i];break}var e=o.convertor(t,n);return[parseFloat(e[0].toFixed(2))/256,parseFloat(e[1].toFixed(2))/256]},o.convertor=function(t,o){if(!t||!o)return null;var r=o[0]+o[1]*Math.abs(t[0]),n=Math.abs(t[1])/o[9],i=o[2]+o[3]*n+o[4]*n*n+o[5]*n*n*n+o[6]*n*n*n*n+o[7]*n*n*n*n*n+o[8]*n*n*n*n*n*n;return r*=t[0]<0?-1:1,i*=t[1]<0?-1:1,[r,i]},o.getRange=function(t,o,r){return null!=o&&(t=Math.max(t,o)),null!=r&&(t=Math.min(t,r)),t},o.getLoop=function(t,o,r){for(;t>r;)t-=r-o;for(;t<o;)t+=r-o;return t},o.EARTHRADIUS=6370996.81,o.MCBAND=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],o.LLBAND=[75,60,45,30,15,0],o.MC2LL=[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],o.LL2MC=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],o}(i.MercatorProjection);o.BaiduProjection=u},function(t,o,r){"use strict";var n=this&&this.__extends||function(t,o){function r(){this.constructor=t}for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)},i=r(3),e=function(t){function o(){t.call(this)}return n(o,t),o.prototype.getTileUrls=function(t){if(t.row<0||t.row>=Math.pow(2,t.zoom))return null;var o=this.sourceCoordinate(t),r=t.row%4+1,n=this.urlTemplate;if("object"==typeof n)return n.map(function(t){return t.format(r,o.column,o.row,o.zoom)});var i=n.format(r,o.column,o.row,o.zoom);return[i]},o.prototype.toString=function(){return"GaoDeProvider_"+this.type},o}(i.AbstractMapProvider);o.GaoDeProvider=e;var a=function(t){function o(){t.call(this),this.type="ROAD",this.urlTemplate="http://webrd0{0}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={1}&y={2}&z={3}"}return n(o,t),o}(e);o.GaoDeProvider_ROAD=a;var u=function(t){function o(){t.call(this),this.type="AERIAL",this.urlTemplate=["http://webst0{0}.is.autonavi.com/appmaptile?scale=1&style=6&x={1}&y={2}&z={3}","http://webst0{0}.is.autonavi.com/appmaptile?scale=1&style=8&x={1}&y={2}&z={3}"]}return n(o,t),o}(e);o.GaoDeProvider_AERIAL=u},function(t,o,r){"use strict";var n=this&&this.__extends||function(t,o){function r(){this.constructor=t}for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)},i=r(3),e=function(t){function o(){t.call(this)}return n(o,t),o.prototype.getTileUrls=function(t){if(t.row<0||t.row>=Math.pow(2,t.zoom))return null;var o=this.sourceCoordinate(t),r=t.row%7,n=this.urlTemplate,i=n.format(r,o.column,o.row,o.zoom);return[i]},o.prototype.toString=function(){return"TianDiProvider_"+this.type},o}(i.AbstractMapProvider);o.TianDiProvider=e;var a=function(t){function o(){t.call(this),this.type="AERIAL",this.urlTemplate="http://t{0}.tianditu.com/DataServer?T=img_w&x={1}&y={2}&l={3}"}return n(o,t),o}(e);o.TianDiProvider_AERIAL=a;var u=function(t){function o(){t.call(this),this.type="ROAD",this.urlTemplate="http://t{0}.tianditu.com/DataServer?T=vec_w&x={1}&y={2}&l={3}"}return n(o,t),o}(e);o.TianDiProvider_ROAD=u},function(t,o,r){"use strict";var n=r(4),i=r(7),e=function(){function t(t,o,r,n){this.provider=t,this.lonlat=new i.LonLat(o,r);var e=t.locationCoordinate(this.lonlat),a=n-e.zoom;this.coordinate=e.zoomBy(a).container();var u=this.coordinate.zoomBy(-a),s=Math.pow(2,a);this.scaleValue=t.tileWidth*s,this.offset=[(e.column-u.column)*this.scaleValue,(e.row-u.row)*this.scaleValue],this.realMaxCoordinate=e}return t.prototype.getUrls=function(){return void 0===this.urls&&(this.urls=this.provider.getTileUrls(this.coordinate)),this.urls},t.prototype.getOffsetLonlat=function(t){var o=this.realMaxCoordinate.column-t[0]/this.scaleValue,r=this.realMaxCoordinate.row-t[1]/this.scaleValue,i=new n.Coordinate(r,o,this.realMaxCoordinate.zoom);return this.provider.coordinateLocation(i)},t.prototype.toString=function(){var t=this.lonlat,o=[Math.PI*t.lon/180,Math.PI*t.lat/180],r=this.provider.projection.rawProject(o),n="provider:"+this.provider.toString()+"\nlonlat:"+t.toString()+"(经纬度-地理坐标)\ntransformXY:"+r.toString()+"(投影坐标)\nmaxCoordinate:"+this.realMaxCoordinate.container().toString()+"(26级瓦片坐标)\ncoordinate:"+this.coordinate.toString()+"(瓦片坐标)\nscaleValue:"+this.scaleValue.toString()+"\noffset:"+this.offset+"(偏移坐标)\nurls:"+this.getUrls()+"(瓦片服务地址)\n";return n},t}();o.MapTile=e}]);