<!DOCTYPE html>
<html>

<head>
  <title>map</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
</head>
<body style="padding-left:5px">
  <div class="input-group TextInput" style="margin-top:5px">
    <span class="input-group-btn">
           <button  class="btn btn-default" type="button" onclick="handleClick(event)" >查询</button>
     </span>
    <input type="text" id="inputText" value="119.3,26.08,5" class="form-control" placeholder="lon,lat,zoom" />
  </div>
  <div>
    <span id="message"></span>
  </div>
  <div>
    <img id="tile" style="" />
  </div>
</body>
<script src="js/map.js"></script>
<script>
      var index = 0
      //
      function handleClick(event){
        var providers = ["GoogleProvider_AERIAL","TianDiProvider_AERIAL","GaoDeProvider_AERIAL"]
        var server = new MapServer(providers[index%3]);
        index++
        var val = document.getElementById("inputText").value;
        var vals = val.split(",")
        var tile;
        if(vals.length>1){
          var lon = parseFloat(vals[0]);
          var lat = parseFloat(vals[1]);
          var zoom = vals.length>2?vals[2]:0;
          var date = new Date();
          tile = server.getMapTile(lon,lat,zoom);
          var useDate = new Date()-date;
          document.getElementById("message").innerText = tile.toString()+"耗时:"+useDate+"ms";
          var urls  = tile.getUrls();
          if(urls){
            document.getElementById("tile").src = urls[0];
          }else{
            document.getElementById("tile").src = null;
          }
          
        }
      }
</script>
</html>